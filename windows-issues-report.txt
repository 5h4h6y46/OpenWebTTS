Hi! I've been testing OpenWebTTS on Windows and ran into several issues that prevented it from running. I've fixed them all and wanted to share what I found so you can include the fixes in the main repo.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› CRITICAL: Unicode/Character Encoding Crash on Windows
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The app crashes with this error when handling text with special characters:
"'charmap' codec can't encode character '\u0127' in position 1570: character maps to <undefined>"

PROBLEM:
Windows uses the 'charmap' codec (cp1252) by default, which can't handle Unicode characters outside of its limited range. The file operations in the codebase don't specify UTF-8 encoding, so Python uses the Windows default.

WHERE IT HAPPENS:
â€¢ functions/users.py - All the JSON read/write operations (lines 46, 55, 66, 81)
â€¢ functions/routes.py - Config file write operation (line 325)

THE FIX:
Add encoding='utf-8' to all open() calls that handle text/JSON:

In users.py:
- Change: with open(user_file, 'w') as f:
- To:     with open(user_file, 'w', encoding='utf-8') as f:

In routes.py:
- Change: with open(config_path, "w") as f:
- To:     with open(config_path, "w", encoding="utf-8") as f:

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› BUG: PDF.js Module Not Loading
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Browser console error:
"Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of 'text/plain'"
"Uncaught ReferenceError: pdfjsLib is not defined"

PROBLEM:
Two issues here:
1. FastAPI's StaticFiles doesn't recognize .mjs files as JavaScript modules by default
2. PDF.js is loaded as a script tag in HTML but not properly imported in the JavaScript module

THE FIX:
1. In app.py, add MIME type configuration:
   import mimetypes
   mimetypes.add_type('application/javascript', '.mjs')
   (Add this before the FastAPI setup)

2. In static/js/index.js, add the import at the top:
   import * as pdfjsLib from './pdf.min.mjs';

3. In templates/index.html, remove the duplicate script tag:
   Remove: <script type="module" src="/static/js/pdf.min.mjs"></script>

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› BUG: Notification System Crashes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Browser console error:
"Uncaught TypeError: Cannot read properties of null (reading 'reverse')"

PROBLEM:
When there are no notifications in localStorage, getItem() returns null. The code tries to call .reverse() on null, which crashes.

WHERE: static/js/UI.js around line 55

THE FIX:
Check if localStorage returns null before parsing:

- Change: const notifications = JSON.parse(localStorage.getItem('notifications')).reverse();
- To:     const notificationsData = localStorage.getItem('notifications');
         if (!notificationsData) return;
         const notifications = JSON.parse(notificationsData).reverse();

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› ï¸ ENHANCEMENT: Windows Build Script Compatibility
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The npm build fails on Windows because package.json uses Unix commands (cp, rm) that don't exist in PowerShell/CMD.

ERROR:
"'cp' is not recognized as an internal or external command"
"'rm' is not recognized as an internal or external command"

THE FIX:
Replace the Unix commands in package.json with Node.js file operations that work cross-platform:

"scripts": {
    "build-css": "npx @tailwindcss/cli -i ./static/css/pre.css -o ./static/css/style.css",
    "build-pdf-js": "node -e \"require('fs').copyFileSync('node_modules/pdfjs-dist/build/pdf.min.mjs', 'static/js/pdf.min.mjs'); require('fs').copyFileSync('node_modules/pdfjs-dist/build/pdf.worker.min.mjs', 'static/js/pdf.worker.min.mjs');\"",
    "build-marked": "node -e \"require('fs').copyFileSync('node_modules/marked/lib/marked.umd.js', 'static/js/marked.umd.js');\"",
    "build-icons": "node -e \"const fs=require('fs');const path=require('path');if(fs.existsSync('static/icons'))fs.rmSync('static/icons',{recursive:true});fs.cpSync('node_modules/@fortawesome/fontawesome-free','static/icons',{recursive:true});\"",
    "build": "concurrently \"npm run build-pdf-js\" \"npm run build-marked\" \"npm run build-icons\" \"npm run build-css\""
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› ï¸ NICE TO HAVE: Password Field HTML Warning
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Browser console shows:
"Password field is not contained in a form"

Not breaking anything, but it's a best practice warning. Modern browsers recommend password fields be inside <form> tags for better accessibility and password manager integration.

THE FIX:
In templates/index.html, wrap the login inputs in a form tag:

<form id="login-form" autocomplete="on">
    <input type="text" id="login-username-input" name="username" autocomplete="username" ...>
    <input type="password" id="login-password-input" name="password" autocomplete="current-password" ...>
</form>

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â„¹ï¸ NOTE: Authentication "Errors" Are Actually Working Correctly
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

You might see these in the browser console:
â€¢ "Failed to load resource: 400 (Bad Request)" on /api/users/create
â€¢ "Failed to load resource: 401 (Unauthorized)" on /api/users/login

These are NOT bugs! They're the correct HTTP status codes:
â€¢ 400 = User already exists (validation working correctly)
â€¢ 401 = Wrong username/password (authentication working correctly)

The browser just shows them as "failed" but they're actually successful error responses with proper messages.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TESTING RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

I've tested all the fixes and everything works perfectly:
âœ… User creation and authentication working
âœ… PDF upload and viewing working
âœ… All TTS engines loading correctly
âœ… Unicode characters handled properly
âœ… Notifications system working
âœ… No JavaScript console errors

Environment tested:
â€¢ Windows 11
â€¢ Python 3.12.0 (in virtual environment)
â€¢ Node.js for npm build
â€¢ All dependencies from requirements.txt installed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Let me know if you need any clarification on these fixes or want me to submit a PR with the changes!
